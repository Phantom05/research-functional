<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
</head>

<body>

  <!-- <script src="./main.js"></script> -->
  <script src="./_.js"></script>
  <script src="./partial.js"></script>
  <!-- <script>
    // 순수함수
    function add(a, b) {
      return a + b;
    }

    console.log(add(10, 5));
    console.log(add(10, 5));
    console.log(add(10, 5));
    console.log(add(10, 5));
    console.log(add(10, 10));

    // add2 는 부수효과를 가져옴.
    var c = 10;

    function add2(a, b) {
      return a + b + c;
    }
    console.log(
      add2(1, 1)
    );

    var cd = 20;

    function add3(a, b) {
      c = b;
      return a + b;
    }
    console.log(
      add3(20, 30)
    );

    var obj1 = {
      val: 10
    };

    function add4(obj, b) {
      obj.val += b;
    }
    add4(obj1, 20);
    console.log(obj1);

    // 참조만 할 뿐 값을 직접 변경하는 것은 없음.
    var obj1 = {
      val: 10
    };

    function add5(obj, b) {
      return {
        val: obj.val + b
      }
    }
    console.log(
      add5(obj1, 10)
    );
    console.log(obj1);
    console.clear();

    function add999(obj, b) {
      let new_obj = Object.assign({}, obj);
      new_obj.val += b
      return new_obj;
    }
    console.log(
      add999(obj1, 10)
    );
    console.log(obj1);

    // 싱글턴
    var Single = (function () {
      function Single() {

      }
      Single.__proto__.hello = function () {
        return 'world'
      }
      Single.__proto__.world = function () {
        return 'hello'
      }

      return Single
    })();

    console.dir(
      Single.world()
    );
    console.dir(Single);

    console.clear()

    // 일급 함수.
    var f1 = function (a) {
      return a * a
    }
    var f2 = add;
    // console.log(f2);

    function f3(f) {
      return f()
    }

    console.log(f3(function () {
      return 10
    }));
    console.log(f3(function () {
      return 20
    }));

    function add_maker(a) {
      return function (b) {
        return a + b;
      }
    }


    var add10 = add_maker(add(5, 5));
    var add15 = add_maker(15);
    console.log(
      add10(add(10, 10))
    );
    console.log(
      add15(10)
    );

    function f4(f1, f2, f3) {
      return f3(f1() + f2())
    }

    console.log(
      f4(
        () => 2,
        () => 5,
        a => a * a
      )
    );

    console.clear();

    var users = [{
        id: 1,
        name: "ID",
        age: 36
      },
      {
        id: 2,
        name: "BJ",
        age: 32
      },
      {
        id: 3,
        name: "JM",
        age: 32
      },
      {
        id: 4,
        name: "PJ",
        age: 27
      },
      {
        id: 5,
        name: "HA",
        age: 25
      },
      {
        id: 6,
        name: "JE",
        age: 26
      },
      {
        id: 7,
        name: "JI",
        age: 31
      },
      {
        id: 8,
        name: "MP",
        age: 23
      },
    ];

    var temp_users = [];
    temp_users = _filter(users, function (val) {
      return val.age >= 30
    });
    console.log(temp_users);

    var names = [];
    for (var i = 0; i < temp_users.length; i++) {
      names.push(temp_users[i].name);
    }
    console.log(names);

    var temp_users = [];
    temp_users = _filter(users, function (val) {
      return val.age < 30
    });
    console.log(temp_users);
    // console.log(
    //   _filter(users,function(val){return val.age >= 30})
    // );
    // console.log(
    //   _filter(users,function(val){return val.age < 30})
    // );
    // console.log(
    //   _map(users,function(val){return val.name})
    // );
    // console.log(
    //   _filter([1,2,3,4],function(val){return val >= 3})
    // );


    console.clear();

    var over_30 = _filter(users, function (val) {
      return val.age >= 30
    });
    var names = _map(over_30, function (val) {
      return val.name
    });

    console.log(names);
    var under_30 = _filter(users, function (val) {
      return val.age < 30
    });
    var age = _map(under_30, function (val) {
      return val.age
    });

    console.log(age);
    console.log(
      _map([1, 2, 3], function (num) {
        return num * 2
      })
    );
    console.clear();


    console.log(
      _map(
        _filter(users, function (users) {
          return users.age >= 30
        }),
        function (user) {
          return user.name
        }));

    console.log(
      _map(
        _filter(users, function (users) {
          return users.age < 30
        }),
        function (user) {
          return user.age
        }));


    console.log(
      [1, 2, 3].map(function (val) {
        return val * 2
      })
    );
    console.log(
      [1, 2, 3, 4].filter(function (val) {
        return val > 2
      })
    );


    console.log(
      _map(document.getElementsByTagName('*'), function (val) {
        return val.nodeName
      })
    );
    // 함수형에선 콜백함수의 이름이 중요함, 무조건 돌려주기만 하는 함수는 콜백
    // 조건이 들어가는 함수는 프리디케이트 함수
    // 반복문을 돌려주는 함수는 이터함수
    // 매핑을 해주는 함수는 mapper함수


    // var add =   _curry(add);
    // var add10 = add(10);
    // var add25 = add10(15);
    // console.log(add25);

    // var add = _curry(function(a,b){
    //   return a+b
    // });
    // var add10 = add(10);

    // console.log(
    //   add10(5)
    // );

    var c_add = _curry(function (a, b) {
      return a * 50 + b + 50
    });

    console.log(
      c_add(add(10, 10))(50)
    );

    var add10 = c_add(10);
    var add5 = c_add(5);
    console.log(
      add10(5)
    );
    console.log(
      add5(5)
    );


    console.log(
      c_add(10, 5)
    );
    console.clear();

    var addFn = _curry(function (a, b) {
      return a + b
    });

    var add10 = addFn(5);
    var add20 = add10(10);
    console.log(add20);

    console.log(
      addFn(10, 10)
    );

    var subFn = _curry(function (a, b) {
      return a - b;
    });
    console.log(
      subFn(10, 5)
    );
    var sub10 = subFn(10);
    console.log(
      sub10(5)
    );

    var sub = _curryr(function (a, b) {
      return a - b
    });
    var sub10 = sub(10);
    console.log(
      sub10(5)
    );

    console.clear();

    var user1 = users[0];
    console.log(
      _get('name')(user1)
    );

    var _get_name = _get('name');
    console.log(
      _get_name(users[1])
    );
    console.log(
      _get_name(users[2])
    );


    console.log(
      _map(
        _filter(users, function (users) {
          return users.age >= 30
        }),
        function (user) {
          return user.name
        }));


    console.log(
      _map(
        _filter(users, function (users) {
          return users.age >= 30
        }), _get('name')
      )
    );

    console.clear();

    console.log(
      _reduce([1, 2, 3, 4], add));


    var f1 = _pipe(
      function (a) {
        return a + 1;
      },
      function (a) {
        return a * 2
      },
      function (a) {
        return a * a
      }
    );


    console.log(
      f1(5)
    );


    _go(1,
      function (a) {
        return a + 1;
      },
      function (a) {
        return a * 2
      },
      function (a) {
        return a * a
      },
      console.log
    );

    _go(users,
      function (users) {
        return _filter(users, function (user) {
          return user.age < 30;
        })
      },
      function (users) {
        return _map(users, _get('name'))
      },
      console.log
    )

    var _map = _curryr(_map),
      _filter = _curryr(_filter);

    console.log(
      _map([1, 2, 3], function (val) {
        return val * 2
      }));

    console.log(
      _map(function (val) {
        return val * 2
      })([1, 2, 3])
    );

    console.clear();

    _go(users,
      _filter((user) => user.age >= 30),
      _map(_get('name')),
      console.log);

    _go(users,
      _filter((user) => user.age >= 30),
      _map(_get('age')),
      console.log);


    var a = _go(users,
      _filter(user=>user.age > 30)
    );
    console.log(a);

    var test = (a,b) =>({val:1});
    console.log(
      test()
    );
      
    _each(null,console.log);
    console.log(
      _filter(null,function(v){return v;})
    );

    _go([1,2,3,4],
    _filter(function(v){return v % 2;}),
      _map(function(v){return v * v;}),
      console.log
    );


    console.log(
      Object.keys({name:'ID',age:33})
    );

    _go([1,2,3,4],
    console.log);


    console.log(
      _keys(null)
    );
    console.log(
      _keys({valle:'worl'})
    );

    _each({
      13:"ID",
      19:"HD",
      29:"YD"
    },function(name){
      console.log(name);
    });

    console.log(
        _each({
        13:"ID",
        19:"HD",
        29:"YD"
      },function(name){
        return name.toLowerCase();
      })
    );

    _go({
      13:"ID",
      19:"HD",
      29:"YD"
    },
    _map(function(name){
      return name.toLowerCase()
    }),
    console.log
    );

    console.clear();
    _go({
      1:users[0],
      3:users[2],
      5:users[4],
    },
    _map(function(user){
      console.log(user);
      return user.name.toLowerCase();
    }),
    console.log
    )

    
    // 컬렉션 중심 프로그래밍
    console.log(
      _map(users,function(user){
        return user.name
      })
    );

    function _values(data){
      return _map(data,_identity)
    };

    console.log(
      _keys(users[0])
    );
    console.log(
      _values(users[0])
    );

    var a = 10;
    console.log(
      _identity(a)
    );

    console.log(
      _map(_identity)(users[0])
    );

    console.log(
      _pluck(users,'age')
    );
    console.log(
      _pluck(users,'name')
    );

    console.log(
      _reject(users,function(user){
        return user.age > 30
      })
    );

    console.log(
      _compact([1,2,0,false,null,{}])
    );




   _go({
      13:"ID",
      19:"HD",
      29:"YD"
    },
    _filter(name=>name === 'HD'),
    _map(item=>item+' WORLD'),
    console.log);


    console.log(
      _find_index(users,function(user){
      return user.id == 3
    })
    );

    console.log(
    _get(_find(users,function(user){
      return user.name == 'BJ'
    }),'name')
   );

   _go(users,
    _find(function(user){return user.id == 5}),
    _get('age'),
    console.log);

  console.log(
    _some([null,false,0])
  );
  console.log(
    _every([1,2,5,10,20])
  );
  console.log(
    _every([1,2,5,10,false])
  );
    
  console.log(
    _some(users,function(user){
      return user.age > 20;
    })
  )
    
  console.log(
    _min([5,1,2,4,10,5,-4])
  );
  console.log(
    _max([5,1,2,4,10,5,-4])
  );

  console.log(
    _min_by([1,2,4,10,5,-4],Math.abs)
  );

  console.log(
    _max_by([1,2,4,10,5,-4],Math.abs)
  );


  function form(...elm){
    const form  = elt("form",{action:"/ab"});
    form.append(...elm);
    return form
  } 

  const Form  =_curry(form);
  console.log(
    Form(
      elt("input",{type:"text"}),
      // elt("input",{type:"text"}),
      elt("button",{type:'submit'}),
    )
  );



  var _min_by = _curryr(_min_by);
  var _max_by = _curryr(_max_by);

  console.log(
    _min_by(users,function(user){
      return user.age;
    })
  );

  _go(users,
    _filter(user=>user.age>=30),
    _min_by(function(user){
      return user.age
    }),
    console.log);

  _go(users,
    _reject(user=>user.age >= 30),
    _max_by(_get('age')),
    console.log
  )


  console.log(_map);
  </script> -->

  <script>
    var users = [{
        id: 1,
        name: "ID",
        age: 36
      },
      {
        id: 2,
        name: "BJ",
        age: 32
      },
      {
        id: 3,
        name: "JM",
        age: 32
      },
      {
        id: 4,
        name: "PJ",
        age: 27
      },
      {
        id: 5,
        name: "HA",
        age: 25
      },
      {
        id: 6,
        name: "JE",
        age: 26
      },
      {
        id: 7,
        name: "JI",
        age: 31
      },
      {
        id: 8,
        name: "MP",
        age: 23
      },
      {
        id: 9,
        name: "GE",
        age: 11
      },
    ];

    _.go(users,
      _.map(user => ({
        ...user,
        age: user.age + 10
      })),
      _.filter(user => user.age >= 30),
      _.pipe(
        _.map(user => ({
          ...user,
          age: user.age + 20
        })),
        _.filter(user => user.age <= 60)
      ),
      console.log);




    _go(users,
      _filter(user => user.age >= 30),
      _min_by(_get('age')),
      console.log);


    console.clear()
    _go(users,
      _group_by(function (user) {
        return user.age;
      }),
      console.log)

    _go(users,
      _group_by(function (user) {
        return user.age - user.age % 10;
      }),
      console.log);


    _go(users,
      _group_by(function (user) {
        return user.name[0]
      }),
      console.log)

    _go(users,
      _group_by(_pipe(_get('name'), _head)),
      console.log);
    console.log(
      _count_by(users, function (user) {
        return user.age - user.age % 10;
      })
    );

    // _map(users,function(val,key){
    //     console.log(key);
    // });


    console.log(
      _pairs(users[0])
    );
    console.clear();

    console.log(users);

    _go(users,
      _group_by(function (user) {
        return user.name[0]
      }),
      console.log);

    console.clear();

    console.log(
      _map([1, 2, 3], function (val, key) {
        return [key, val]
      })
    );


    console.log(users);
    // _go(users,
    //  _filter(user => user.age < 30),
    //   _count_by((user)=> user.age - user.age %10),
    //   _map((count,key) => `<li>${key}대는 ${count}명 입니다.</li>`),
    //   list=>`<ul>${list.join('')}</ul>`,
    // document.write.bind(document)
    // )


    var f1 = _pipe(
      _filter(user => user.age < 30),
      _count_by((user) => user.age - user.age % 10),
      _map((count, key) => `<li>${key}대는 ${count}명 입니다.</li>`),
      list => `<ul>${list.join('')}</ul>`,
      document.write.bind(document)
    );

    f1(users);

    var f2 = _pipe(
      _reject(user => user.age < 30), f1
    );

    f2(users);


    function solution(n) {
      const res = [];
      while (true) {
        res.push(n % 10);
        n = Math.floor(n / 10);
        if (n === 0) break;
      }
      return res
    }

    console.log(
      solution(12345)
    );

    console.clear();
  </script>

  <script>
    var mi = 0;
    var fi = 0;
    _.go(
      _.range(100),
      _.map(function (val) {
        ++mi;
        return val * val
      }),
      _.filter(function (val) {
        ++fi;
        return val % 2;
      }),

      _.take(5),
      console.log
    );
    console.log(mi, fi);


    var mi = 0;
    var fi = 0;
    _.go(
      _.range(100),
      L.map(function (val) {
        ++mi;
        return val * val
      }),
      L.filter(function (val) {
        ++fi;
        return val % 2;
      }),

      L.take(5),
      console.log
    );



    console.log(mi, fi);



    // function solution(participant, completion) {
    //   const map = new Map();

    //   const obj = participant.reduce((obj, item) => {
    //     if (obj.hasOwnProperty(item)) {
    //       obj[item]++
    //     } else {
    //       obj[item] = 1;
    //     }
    //     return obj;
    //   }, {});
    //   const res = completion.map(item => {
    //     if(obj[item] === 1){
    //       delete obj[item]
    //     }else if (obj[item] === 2){
    //       obj[item]--
    //     }
    //   });

    //   return Object.keys(obj)[0]
    // }



    console.log(mi, fi);

    function solution(participant, completion) {
      const objFromArray = completion.reduce(
        (obj, v) => (obj[v] = obj[v] ? obj[v] + 1 : 1, obj), {});
      return participant.find(v => {
        if (objFromArray[v]) objFromArray[v] = objFromArray[v] - 1;
        else return true;
      });
    }



    // console.log(
    //   solution(
    //     ["mislav", "stanko", "mislav", "ana"], ["stanko", "ana", "mislav"]
    //   )
    // );


    function _each(list, iter) {
      for (var i = 0, len = list.length; i < len; i++) {
        iter(list[i], i);
      }
      return list;
    }

    // function solution(participant, completion) {
    //   const map = new Map();
    //   _each(participant, (item,idx) => {
    //     const b = completion[idx];
    //     map.set(item, (map.get(item) || 0) + 1);
    //     map.set(b, (map.get(b) || 0) - 1)
    //   });

    //   for(let [a,b] of map){
    //     if(b >0) return a
    //   }
    // }

    console.clear();

    //     function solution(clothes) {
    //     let answer = 1;

    //     // 의상의 종류별 개수를 담을 맵 (ex. headgear 2가지, face 1가지 등)
    //     let map = new Map();

    //     // for문을 순회하면서 의상의 종류별 개수를 맵에 저장
    //     let size = clothes.length;
    //     for (let i = 0; i < size; i++) {

    //         if (!map.has(clothes[i][1]))
    //             map.set(clothes[i][1], 1);
    //         else 
    //             map.set(clothes[i][1], map.get(clothes[i][1]) + 1);
    //     }
    //     console.log(map);

    //     /**
    //      * 해당 의상을 선택하지 않을 경우도 있기 때문에 각 개수에 1을 더하고
    //      * 각 의상의 종류별 개수를 곱한다.
    //      */
    //     for (let value of map.values())
    //         answer *= value + 1;

    //     // 모두 선택하지 않은 경우는 제외
    //     return answer - 1;
    // }

    // function solution(clothes) {
    //   const map = new Map();
    //   let res = 1;
    //   const obj = clothes.reduce((obj, item) => {
    //     const val = item[1];
    //     map.set(val, (map.get(val) || 0) + 1);
    //     return obj;
    //   }, map);
    //   for (let value of map.values()) {
    //     res *= value + 1;
    //   }
    //   return res - 1;
    // }


    function solution(clothes) {
      const map = new Map();
      let res = 1;
      const obj = clothes.reduce((obj, item) => {
        const v = item[1];
        const k = obj[v];
        obj[v] = k ? k + 1 : 1;
        return obj;
      }, {});

      for (let value in obj) {
        res *= obj[value] + 1;
      }
      return res - 1;
    }

    function solution(clothes) {
      return Object.values(clothes.reduce((obj, t) => {
        obj[t[1]] = obj[t[1]] ? obj[t[1]] + 1 : 1;
        return obj;
      }, {})).reduce((a, b) => a * (b + 1), 1) - 1;
    }


    function solution(clothes) {
      return Object.values(
          clothes.reduce((obj, t) => (obj[t[1]] = obj[t[1]] ? obj[t[1]] + 1 : 1, obj), {}))
        .reduce((a, b) => a * (b + 1), 1) - 1;
    }


    function solution(answers) {
      const map = new Map;
      map.set("p", [
        [1, 2, 3, 4, 5],
        [2, 1, 2, 3, 2, 4, 2, 5],
        [3, 3, 1, 1, 2, 2, 4, 4, 5, 5],
      ]);

      // for(let [k,v] of map){
      //   console.log(k,v);
      //   console.log(v.length);
      // }

      answers.reduce((arr, val, idx) => {
        console.log(idx);
        map.get('p').filter((item, idx) => {
          // console.log(item);
          item.length
        })
        // if(map.get('p1')[i % map.get('p1').length] === val){

        // }
        return arr
      }, [])
      return answers;
    }



    function solution(answers) {
      const map = new Map();
      map.set('person', [
        [1, 2, 3, 4, 5],
        [2, 1, 2, 3, 2, 4, 2, 5],
        [3, 3, 1, 1, 2, 2, 4, 4, 5, 5]
      ]);
      const p = map.get('person');
      const count = answers.reduce((arr, val, i) => {
        if (p[0][i % p[0].length] === answers[i]) arr[0]++;
        if (p[1][i % p[1].length] === answers[i]) arr[1]++;
        if (p[2][i % p[2].length] === answers[i]) arr[2]++;
        return arr
      }, [0, 0, 0]);
      const max = Math.max(...count);
      return count.reduce((arr, val, idx) => {

        if (val === max) arr.push(Number(idx) + 1);
        return arr
      }, []);
    }


    console.log(
      solution(
        [1, 2, 3, 4, 5]
      )
    );
    // 23
    //     1. yellow_hat
    //     2. blue_sunglasses
    //     3. green_turban
    //     4. yellow_hat + blue_sunglasses
    //     5. green_turban + blue_sunglasses


    // console.log(
    //   solution(
    //    [["crow_mask", "face"], ["blue_sunglasses", "face"], ["smoky_makeup", "face"]]
    //   )
    // )


    function helloworld(...arg) {
      console.log(arg);
      return arg.map(item => item.concat(5))
    }
    const c_helloworld = _curry(helloworld)([
      [1, 2]
    ]);

    console.log(
      c_helloworld([1, 2])
    );
    console.clear();


    var users = [{
        id: 101,
        name: "ID"
      },
      {
        id: 102,
        name: "BJ"
      },
      {
        id: 103,
        name: "PJ"
      },
      {
        id: 104,
        name: "HA"
      },
      {
        id: 105,
        name: "JE"
      },
      {
        id: 106,
        name: "JI"
      },
      {
        id: 109,
        name: "EK"
      },
    ]
    var posts = [{
        id: 201,
        body: "내용1",
        user_id: 101
      },
      {
        id: 202,
        body: "내용2",
        user_id: 101
      },
      {
        id: 203,
        body: "내용3",
        user_id: 103
      },
      {
        id: 204,
        body: "내용4",
        user_id: 104
      },
      {
        id: 205,
        body: "내용5",
        user_id: 101
      },
    ];
    var comments = [{
        id: 300,
        body: "댓글0",
        user_id: 104,
        post_id: 200
      },
      {
        id: 301,
        body: "댓글1",
        user_id: 105,
        post_id: 201
      },
      {
        id: 302,
        body: "댓글2",
        user_id: 106,
        post_id: 202
      },
      {
        id: 303,
        body: "댓글3",
        user_id: 107,
        post_id: 203
      },
      {
        id: 304,
        body: "댓글4",
        user_id: 108,
        post_id: 204
      },
      {
        id: 305,
        body: "댓글5",
        user_id: 109,
        post_id: 205
      },
      {
        id: 306,
        body: "댓글6",
        user_id: 101,
        post_id: 206
      },
      {
        id: 307,
        body: "댓글7",
        user_id: 102,
        post_id: 207
      },
      {
        id: 308,
        body: "댓글8",
        user_id: 103,
        post_id: 208
      },
      {
        id: 309,
        body: "댓글9",
        user_id: 104,
        post_id: 209
      },
    ];



    function posts_by(attr) {
      return _.where(posts, attr);
    }

    var comments_by_posts = _.pipe(
      _.pluck('id'),
      function (post_ids) {
        return _filter(comments, comment => {
          return _.contains(post_ids, comment.post_id)
        })
      },
    );


    // 1. 특정인의 posts의 모든 comments 거르기
    var f1 = _.pipe(posts_by, comments_by_posts);
    console.log( f1({user_id: 101}) );


    // 2, 특정인의 posts에 comments를 단 친구의 이름들 뽑기
    var user_names_by_comments = _.map(comment => {
      return _.find(users, user => user.id === comment.user_id).name
    });
    var f2 = _.pipe(
      f1,
      user_names_by_comments,
      _.uniq)
    console.log( f2({user_id: 101}) );


    // 3. 특정인의 posts에 comments를 단 친구들 카운트 정보
    var f3 = _.pipe(
      f1,
      user_names_by_comments,
      _.count_by
    )
    console.log( f3({user_id:101}) );

    
  </script>
</body>

</html>
